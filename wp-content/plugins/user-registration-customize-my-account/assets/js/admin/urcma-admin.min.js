jQuery(document).ready(function(s){"use strict";var d=s(".urcma-endpoints-options-wrapper");function c(e){var t=tinyMCEPreInit.mceInit,n=Object.keys(t)[0],a=t[n],i=tinyMCEPreInit.qtInit,r=t[Object.keys(i)[0]];a.selector=e,a.body_class=a.body_class.replace(n,e),r.id=e,tinyMCE.init(a),tinyMCE.execCommand("mceRemoveEditor",!0,e),tinyMCE.execCommand("mceAddEditor",!0,e),quicktags(r),QTags._buttonsInit()}"undefined"!=typeof s.fn.sortable&&s(".urcma-endpoint-tabs").sortable({containment:".urcma-endpoint-tabs",tolerance:"pointer",revert:"invalid",forceHelperSize:!0}),s("form#mainform").on("submit",function(e){if("undefined"!=typeof s.fn.sortable){var n=[];s(".urcma-endpoint-selector").each(function(e){var t={type:s(this).data("type"),id:s(this).attr("id")};n.push(t)});var t=JSON.stringify(n);s("input.endpoints-order").val(t)}}),d.on("change",function(e,t){void 0!==t&&c(t.find("textarea").attr("id"))}),s(document).on("click",".add_new_field",function(e){e.stopPropagation();var n=s(this).data("target");Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:urcma_params.add_new_endpoint_title,input:"text",inputAttributes:{autocapitalize:"off"}}).then(function(e){if(e.value){var t=e.value;s(this).add_new_field_handler(n,t)}})}),s.fn.add_new_field_handler=function(e,r){var o=s(this);s.ajax({url:urcma_params.ajaxurl,data:{target:e,field_name:r,action:urcma_params.action_add},dataType:"json",beforeSend:function(){},success:function(e){if(o.find(".loader").hide(),e.error||d.find('[data-id="'+e.field+'"]').length)swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",type:"error",title:"Oops...",text:e.error});else{swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",type:"success",html:r.toUpperCase()+" "+urcma_params.add_endpoint_success_message}).then(function(e){s(".button-primary").trigger("click")});var t=s(e.html),n=s(".urcma-endpoints-options-wrapper");s(".urcma-endpoint-tabs > .urcma-endpoint-selector").removeClass("active"),n.find(".urcma-endpoint-content").attr("style","display:none;");var a='<div class="ur-sidebar-nav-tab urcma-endpoint-selector ui-sortable-handle active" id="'+e.field+'" data-id="'+e.endpoint_label+'" data-type="'+e.type+'">\n'+e.endpoint_label+"</div>";s(".urcma-endpoint-tabs > .urcma-endpoint-selector").last().after(a),s(".urcma-endpoints-options-wrapper .urcma-endpoint-content").last().after(t);var i=e.field;n.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),n.find("#"+i).find(".urcma-endpoint-header").removeAttr("style"),n.find("#"+i).find(".urcma-endpoint-options").removeAttr("style"),l(t.find("select")),c(t.find("textarea").attr("id"))}}})},s(document).on("click",".remove-trigger",function(){var e=s(this).data("endpoint"),t=s("input.endpoint-to-remove");if(void 0===e||!t.length)return!1;if(1!=confirm(urcma_params.remove_alert))return!1;var n=t.val(),a=n.length?n.split(","):[];a.push(e),t.val(a.join(",")),s("#"+e).remove(),s(".urcma-endpoints-wrapper").find("#"+e).remove();var i=s(".urcma-endpoints-options-wrapper"),r=s(".urcma-endpoint-selector:first");r.addClass("active");var o=r.attr("id");i.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),i.find("#"+o).removeAttr("style"),i.find("#"+o).find(".urcma-endpoint-header").removeAttr("style"),i.find("#"+o).find(".urcma-endpoint-options").removeAttr("style")}),s(document).ready(function(){var t=s(".urcma-endpoints-options-wrapper"),e=s(".urcma-endpoints-list nav"),n=s(".urcma-endpoint-selector:first");n.addClass("active");var a=n.attr("id");t.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),t.find("#"+a).find(".urcma-endpoint-header").removeAttr("style"),t.find("#"+a).find(".urcma-endpoint-options").removeAttr("style"),e.find(".urcma-endpoint-selector").on("click",function(){var e=s(this).attr("id");s(this).siblings().removeClass("active"),s(this).addClass("active"),t.find(".urcma-endpoint-content").attr("style","display:none;"),t.find("#"+e).removeAttr("style"),t.find(".urcma-endpoint-content .urcma-endpoint-header").removeAttr("style"),t.find("#"+e).find(".urcma-endpoint-options").removeAttr("style")})});function a(e){return s('<span><i class="fa fa-'+e.text+'"></i>   '+e.text+"</span>")}function l(e,t){var n;"undefined"!=typeof s.fn.select2&&s.each(e,function(){n=s(this).hasClass("icon-select")?{templateResult:a,templateSelection:a,width:"100%"}:t?{width:"100%"}:{minimumResultsForSearch:10},s(this).select2(n)})}s(document).on("change",".hide-show-check",function(){var e,t,n,a,i;e="checkbox",t=s(this),n=t.closest(".urcma-endpoint-content").find(".hide-show-check"),a="checkbox"==e?t:n.first(),!0==(i=!!(a.is(":checked")&&"checkbox"==e||!a.is(":checked")&&"link"==e))?(n.prop("checked",i),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").addClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.enable_endpoint)):(n.removeAttr("checked",i),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").removeClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.disable_endpoint))}),s(document).on("change keyup",".urcma_slug_input",function(){var a=s(this);s(".urcma-endpoint-options").find(".urcma_slug_input").each(function(e,t){var n=s(t);n.is(a)||s.trim(n.val())===s.trim(a.val())&&(swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",type:"error",title:"Oops...",text:urcma_params.same_slug_error_message}),s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")}))}),s(".submit").find(".button-primary").removeAttr("disabled")}),s(document).on("change keyup",".urcma_label_input",function(){var a=s(this);s(".urcma-endpoint-options").find(".urcma_label_input").each(function(e,t){var n=s(t);if(!n.is(a)&&s.trim(n.val())===s.trim(a.val()))return swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",type:"error",title:"Oops...",text:urcma_params.same_label_error_message}),void s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")})}),s(".submit").find(".button-primary").removeAttr("disabled")}),l(d.find("select"),!0)});